gpmt=# explain select * from (select c1.oid,(select relname from pg_attribute c2 where c2.attrelid = c1.oid limit 1),(select relname from pg_attribute c2 where c2.atttypid = c1.oid limit 1) from pg_class c1) a, pg_class c, sales s;
                                                  QUERY PLAN
--------------------------------------------------------------------------------------------------------------
 Nested Loop  (cost=175425.45..16524948505331.79 rows=1671897473232 width=280)
   ->  Nested Loop  (cost=11.18..6338.68 rows=315844 width=272)
         ->  Seq Scan on pg_class c1  (cost=0.00..10.62 rows=562 width=68)
         ->  Materialize  (cost=11.18..16.80 rows=281 width=204)
               ->  Seq Scan on pg_class c  (cost=0.00..10.62 rows=562 width=204)
   ->  Materialize  (cost=175414.27..233518.55 rows=2646714 width=8)
         ->  Gather Motion 2:1  (slice1; segments: 2)  (cost=0.00..164950.84 rows=5293428 width=8)
               ->  Append  (cost=0.00..59082.28 rows=2646714 width=8)
                     ->  Seq Scan on sales_1_prt_outlying_years s  (cost=0.00..55276.72 rows=2476236 width=8)
                     ->  Seq Scan on sales_1_prt_2 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_3 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_4 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_5 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_6 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_7 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_8 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_9 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_10 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_11 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_12 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_13 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_14 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_15 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_16 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_17 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_18 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_19 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_20 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_21 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_22 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_23 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_24 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_25 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_26 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_27 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_28 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_29 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_30 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_31 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_32 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_33 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_34 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_35 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_36 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_37 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_38 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_39 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_40 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_41 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_42 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_43 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_44 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_45 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_46 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_47 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_48 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_49 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_50 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_51 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_52 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_53 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_54 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_55 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_56 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_57 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_58 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_59 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_60 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_61 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_62 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_63 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_64 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_65 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_66 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_67 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_68 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_69 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_70 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_71 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_72 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_73 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_74 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_75 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_76 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_77 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_78 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_79 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_80 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_81 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_82 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_83 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_84 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_85 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_86 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_87 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_88 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_89 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_90 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_91 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_92 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_93 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_94 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_95 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_96 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_97 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_98 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_99 s  (cost=0.00..38.44 rows=1722 width=8)
                     ->  Seq Scan on sales_1_prt_100 s  (cost=0.00..38.44 rows=1722 width=8)
   SubPlan 2
     ->  Limit  (cost=0.00..0.64 rows=1 width=0)
           ->  Seq Scan on pg_attribute c2  (cost=0.00..71.00 rows=112 width=0)
                 Filter: atttypid = $1
   SubPlan 1
     ->  Limit  (cost=0.00..9.23 rows=1 width=0)
           ->  Seq Scan on pg_attribute c2  (cost=0.00..71.00 rows=8 width=0)
                 Filter: attrelid = $1
 Settings:  optimizer=on
 Optimizer status: legacy query optimizer
(118 rows)


